<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBR System - Groq Simulation Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .interactions {
            padding: 30px;
        }

        .interaction-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
            transition: box-shadow 0.3s;
        }

        .interaction-card:hover {
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .interaction-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .interaction-header h3 {
            font-size: 1.3rem;
        }

        .score-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .interaction-content {
            padding: 25px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        .request-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .request-item {
            display: flex;
            align-items: center;
        }

        .request-label {
            font-weight: 600;
            color: #495057;
            margin-right: 10px;
        }

        .request-value {
            color: #212529;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .badge-diet {
            background: #d4edda;
            color: #155724;
        }

        .badge-ingredient {
            background: #f8d7da;
            color: #721c24;
        }

        .badge-event {
            background: #cfe2ff;
            color: #084298;
        }

        .feedback-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .feedback-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .feedback-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 8px;
        }

        .feedback-bar-container {
            background: #e9ecef;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .feedback-bar {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .feedback-bar.price { background: linear-gradient(90deg, #28a745, #20c997); }
        .feedback-bar.culture { background: linear-gradient(90deg, #ffc107, #fd7e14); }
        .feedback-bar.flavor { background: linear-gradient(90deg, #e83e8c, #dc3545); }
        .feedback-bar.dietary { background: linear-gradient(90deg, #17a2b8, #007bff); }
        .feedback-bar.overall { background: linear-gradient(90deg, #6610f2, #6f42c1); }

        .feedback-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
        }

        .menus-grid {
            display: grid;
            gap: 20px;
        }

        .menu-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
        }

        .menu-card.best {
            border: 3px solid #28a745;
            background: #d4edda;
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }

        .menu-title {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .menu-price {
            font-size: 1.2rem;
            font-weight: bold;
            color: #28a745;
        }

        .dish-item {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }

        .dish-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .dish-details {
            font-size: 0.85rem;
            color: #666;
        }

        .adaptations-list {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .adaptation-item {
            padding: 8px 0;
            border-bottom: 1px solid #ffe69c;
        }

        .adaptation-item:last-child {
            border-bottom: none;
        }

        .llm-evaluation {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .llm-evaluation-text {
            color: #333;
            line-height: 1.8;
            white-space: pre-line;
        }

        .collapse-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .collapse-btn.collapsed {
            transform: rotate(-90deg);
        }

        .content-collapsed {
            display: none;
        }

        footer {
            background: #212529;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .request-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üçΩÔ∏è CBR System - Simulation Report</h1>
            <div class="subtitle">Groq LLM Evaluation Results</div>
        </header>

        <div id="stats" class="stats-grid"></div>

        <div class="interactions" id="interactions"></div>

        <footer>
            <p>Generated on <span id="timestamp"></span></p>
            <p>Case-Based Reasoning System with Adaptive Weight Learning</p>
        </footer>
    </div>

    <script>
        // Datos embebidos directamente (no requiere servidor)
        const embeddedData = {"config": {"model_name": "llama-3.3-70b-versatile", "num_interactions": 5, "enable_adaptive_weights": true, "temperature": 0.9}, "interactions": [{"request_num": 1, "generated_request": {"event_type": "CORPORATE", "num_guests": 6, "season": "AUTUMN", "price_min": 18, "price_max": 35, "wants_wine": true, "required_diets": [], "restricted_ingredients": ["dairy", "eggs"], "preferred_style": null, "cultural_preference": null}, "proposed_dishes": ["Chopped Caesar Salad Pizza", "Steamed Ribs in Black Bean Sauce (Ë±âÊ±ÅËí∏ÊéíÈ™®)", "Strawberry Pomegranete Sorbet", "Grilled Pepper Jack Chicken Sandwiches", "Okra and Onion Stir fry. Mom‚Äôs Pyaaz Waali Bhindi.", "Panna Cotta with Fresh Berries", "Southern Baked Parmesan Chicken, Courgette, Tomato and Bulgur Wheat Summer Salad Bowl", "Pressure Cooker Indian Curry Lamb Spareribs", "Avocado coconut ice cream"], "adaptations_made": ["Sustituido Bacon Mac and Cheese for Crockpot por Steamed Ribs in Black Bean Sauce (Ë±âÊ±ÅËí∏ÊéíÈ™®) (ahorro: 3.50‚Ç¨)", "Sustituido Sesame Chicken Salad with Honey Sesame Dressing por Chopped Caesar Salad Pizza (m√°s apropiado para autumn)", "‚öôÔ∏è Precios ajustados preventivamente (-11.00‚Ç¨ para cumplir presupuesto)", "Sustituido Hot Brown Sandwiches por Grilled Pepper Jack Chicken Sandwiches (ahorro: 21.00‚Ç¨)", "Sustituido Homemade Eggnog and Video por Panna Cotta with Fresh Berries (ahorro: 7.00‚Ç¨)", "Sustituido Roasted Beets with Balsamic Glaze por Okra and Onion Stir fry. Mom‚Äôs Pyaaz Waali Bhindi. (ahorro: 3.50‚Ç¨)", "‚ö†Ô∏è No se pudo reducir completamente el precio (faltan 7.50‚Ç¨)", "‚öôÔ∏è Precios ajustados preventivamente (-7.50‚Ç¨ para cumplir presupuesto)", "Sustituido Grilled Polenta with Spicy Steak por Pressure Cooker Indian Curry Lamb Spareribs (ahorro: 7.00‚Ç¨)", "Sustituido DEEP DISH CARAMEL APPLE PIE por Avocado coconut ice cream (ahorro: 3.50‚Ç¨)"], "menus_details": [{"starter": {"name": "Chopped Caesar Salad Pizza", "ingredients": ["olive oil", "mozzarella cheese", "parmesan cheese", "parmesan cheese", "chicken breasts", "salt", "black pepper", "parmesan cheese", "mayonnaise", "lemon juice"], "price": 15.978260869565219, "calories": 5363}, "main_course": {"name": "Steamed Ribs in Black Bean Sauce (Ë±âÊ±ÅËí∏ÊéíÈ™®)", "ingredients": ["green onions", "ginger", "chili peppers", "vegetable oil", "white wine", "ginger", "garlic", "cornstarch", "sugar", "salt"], "price": 7.989130434782609, "calories": 1325}, "dessert": {"name": "Strawberry Pomegranete Sorbet", "ingredients": ["sugar", "lemon juice", "cornstarch", "strawberries"], "price": 7.989130434782609, "calories": 1072}, "beverage": {"name": "Josh Cellars Cabernet Sauvignon", "price": 3.0434782608695654, "alcoholic": true}, "total_price": 35.0, "total_calories": 7760, "similarity_score": 0.709529411764706, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (7760 kcal) para autumn\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad high podr√≠a no ser ideal para corporate\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}, {"starter": {"name": "Grilled Pepper Jack Chicken Sandwiches", "ingredients": ["chicken breasts", "bacon", "jack cheese", "lettuce", "onion", "tomatoes"], "price": 5.764705882352941, "calories": 979}, "main_course": {"name": "Okra and Onion Stir fry. Mom‚Äôs Pyaaz Waali Bhindi.", "ingredients": ["vegetable oil", "onion", "turmeric", "green chilies", "salt", "chili peppers"], "price": 8.647058823529411, "calories": 258}, "dessert": {"name": "Panna Cotta with Fresh Berries", "ingredients": ["heavy cream", "milk", "sugar", "blackberries", "raspberries", "strawberries", "sugar"], "price": 17.294117647058822, "calories": 2369}, "beverage": {"name": "Josh Cellars Cabernet Sauvignon", "price": 3.2941176470588234, "alcoholic": true}, "total_price": 35.0, "total_calories": 3606, "similarity_score": 0.6890000000000001, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (3606 kcal) para autumn\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}, {"starter": {"name": "Southern Baked Parmesan Chicken, Courgette, Tomato and Bulgur Wheat Summer Salad Bowl", "ingredients": ["olive oil", "smoked paprika", "parmesan cheese", "bulgur", "rice", "cherry tomatoes", "lettuce", "olive oil", "lemon", "honey"], "price": 7.0, "calories": 1960}, "main_course": {"name": "Pressure Cooker Indian Curry Lamb Spareribs", "ingredients": ["salt", "curry powder", "coconut oil", "onion", "tomatoes", "garlic", "curry powder", "salt", "lemon", "cilantro"], "price": 7.0, "calories": 3473}, "dessert": {"name": "Avocado coconut ice cream", "ingredients": ["avocado", "coconut milk", "sugar", "lime juice", "rum", "salt"], "price": 10.5, "calories": 1931}, "beverage": {"name": "Caymus Cabernet Sauvignon", "price": 8.0, "alcoholic": true}, "total_price": 32.5, "total_calories": 7364, "similarity_score": 0.601, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (7364 kcal) para autumn\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad high podr√≠a no ser ideal para corporate\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}], "llm_evaluation": "La evaluaci√≥n del men√∫ propuesto se basa en las dimensiones de precio, cultura, sabor y dieta.\n\nEl precio total del men√∫ se ajusta dentro del presupuesto establecido, lo que es un punto a favor. Sin embargo, la cultura y el sabor pueden requerir un an√°lisis m√°s detallado, considerando las adaptaciones realizadas y la coherencia de los platos. \n\nEl men√∫ muestra un esfuerzo por adaptarse a las necesidades del evento corporativo y a la temporada de oto√±o, aunque puede carecer de un enfoque cultural espec√≠fico debido a la falta de preferencias culturales explicitadas. Los sabores y combinaciones de ingredientes pueden ser interesantes, aunque la coherencia y complementariedad entre platos requiere una evaluaci√≥n m√°s profunda.\n\nPRECIO: 4.5\nCULTURA: 3.0\nSABOR: 4.0\nGENERAL: 4.0", "llm_score": 4.0, "feedback_breakdown": {"overall_satisfaction": 4.0, "price_satisfaction": 4.5, "cultural_satisfaction": 3.0, "dietary_satisfaction": 5.0, "flavor_satisfaction": 4.0}, "timestamp": "2026-01-09T20:13:58.570912"}, {"request_num": 2, "generated_request": {"event_type": "CORPORATE", "num_guests": 33, "season": "SUMMER", "price_min": 40, "price_max": 74, "wants_wine": true, "required_diets": [], "restricted_ingredients": ["dairy"], "preferred_style": null, "cultural_preference": null}, "proposed_dishes": ["Hot Brown Sandwiches", "Roasted Beets with Balsamic Glaze", "Homemade Eggnog and Video", "Cheddar-Apple Turkey Salad", "Mini Turkey Meatloaf with Ranch Potatoes and Broccoli", "Chocolate Chunk Pancakes with Fresh Raspberry Maple Syrup", "Recipe: Summer Vegetable Grain Salad", "CAPOCOLLO AND MINI SWEET PEPPER PASTA", "Homemade Nutter Butters"], "adaptations_made": ["Sustituido Jalapeno Kaiser Hamburger Bun por Cheddar-Apple Turkey Salad (m√°s apropiado para summer)", "Sustituido Bourbon Pecan Bread por Recipe: Summer Vegetable Grain Salad (m√°s apropiado para summer)"], "menus_details": [{"starter": {"name": "Hot Brown Sandwiches", "ingredients": ["butter", "all-purpose flour", "milk", "chicken broth", "worcestershire sauce", "cheddar cheese", "salt", "white pepper", "bacon", "tomatoes"], "price": 28.0, "calories": 4183}, "main_course": {"name": "Roasted Beets with Balsamic Glaze", "ingredients": ["beets", "beets", "balsamic vinegar", "honey", "salt", "black pepper"], "price": 14.0, "calories": 392}, "dessert": {"name": "Homemade Eggnog and Video", "ingredients": ["sugar", "egg yolks", "salt", "milk", "heavy cream", "sugar", "egg whites", "nutmeg", "vanilla extract"], "price": 28.0, "calories": 3175}, "beverage": {"name": "Josh Cellars Cabernet Sauvignon", "price": 4.0, "alcoholic": true}, "total_price": 74.0, "total_calories": 7750, "similarity_score": 0.9275724275724274, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (7750 kcal) para summer\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}, {"starter": {"name": "Cheddar-Apple Turkey Salad", "ingredients": ["apples", "cheddar cheese", "green onions", "salt"], "price": 14.0, "calories": 1791}, "main_course": {"name": "Mini Turkey Meatloaf with Ranch Potatoes and Broccoli", "ingredients": ["broccoli", "seasoning", "olive oil", "lemon juice", "carrots", "zucchini", "onion", "garlic", "parsley", "ground turkey"], "price": 21.0, "calories": 2028}, "dessert": {"name": "Chocolate Chunk Pancakes with Fresh Raspberry Maple Syrup", "ingredients": ["maple syrup", "raspberries", "all-purpose flour", "baking powder", "baking soda", "salt", "milk", "eggs", "vanilla extract", "dark chocolate"], "price": 21.0, "calories": 3021}, "beverage": {"name": "Josh Cellars Cabernet Sauvignon", "price": 4.0, "alcoholic": true}, "total_price": 60.0, "total_calories": 6840, "similarity_score": 0.8651348651348649, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (6840 kcal) para summer\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}, {"starter": {"name": "Recipe: Summer Vegetable Grain Salad", "ingredients": ["quinoa", "water", "salt", "bell peppers", "salt", "black pepper", "red wine vinegar"], "price": 28.0, "calories": 2007}, "main_course": {"name": "CAPOCOLLO AND MINI SWEET PEPPER PASTA", "ingredients": ["pasta", "red onion", "garlic", "oregano", "ricotta cheese", "salt"], "price": 14.0, "calories": 1897}, "dessert": {"name": "Homemade Nutter Butters", "ingredients": ["sugar", "peanut butter", "eggs", "butter", "peanut butter", "powdered sugar", "milk"], "price": 14.0, "calories": 4920}, "beverage": {"name": "Kendall-Jackson Cabernet Sauvignon", "price": 4.5, "alcoholic": true}, "total_price": 60.5, "total_calories": 8824, "similarity_score": 0.8201798201798199, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (8824 kcal) para summer\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}], "llm_evaluation": "La evaluaci√≥n del men√∫ propuesto se centra en varias dimensiones clave. En cuanto al precio, el men√∫ est√° en el l√≠mite superior del presupuesto, lo que podr√≠a ser un desaf√≠o para algunos eventos corporativos. La cultura no es un factor significativo en este caso, ya que no se solicitaron preferencias culturales espec√≠ficas, aunque las adaptaciones para ajustarse a la temporada de verano son apreciables. La coherencia de sabores y la complementariedad de los platos son aspectos importantes a considerar.\n\nPRECIO: 4.5\nCULTURA: 3.5\nSABOR: 4.0\nGENERAL: 4.0", "llm_score": 4.0, "feedback_breakdown": {"overall_satisfaction": 4.0, "price_satisfaction": 4.5, "cultural_satisfaction": 3.5, "dietary_satisfaction": 5.0, "flavor_satisfaction": 4.0}, "timestamp": "2026-01-09T20:13:59.864578"}, {"request_num": 3, "generated_request": {"event_type": "WEDDING", "num_guests": 4, "season": "SPRING", "price_min": 27, "price_max": 55, "wants_wine": false, "required_diets": [], "restricted_ingredients": [], "preferred_style": "FUSION", "cultural_preference": "LEBANESE"}, "proposed_dishes": ["Greek Salad", "Bacon Mac and Cheese for Crockpot", "Blackberry Oatmeal Breakfast Cookies", "Apple and Brussels Sprout Salad", "Pineapple Sweet and Sour Chicken (Easy and Delicious!)", "Accidentally Vegan Banana-Nut Muffins"], "adaptations_made": ["Cambiado Caymus Cabernet Sauvignon por Ginger Lemon Blend (sin alcohol)", "Cambiado Bogle Cabernet Sauvignon por Fanta Orange (sin alcohol)", "Men√∫ adaptado culturalmente: chinese ‚Üí lebanese", "Apple and Brussels Sprout Salad: apple cider vinegar‚Üíwhite vinegar (+6%), dried cranberries‚Üídates (+9%), pecans‚Üípistachios (+9%), bacon‚Üíchicken breasts (+6%) (cultural: 37%‚Üí68%, global: 93.4%)", "Accidentally Vegan Banana-Nut Muffins: pecans‚Üípistachios (+6%), almond milk‚Üíyogurt (+3%), apples‚Üípears (+4%), ground cinnamon‚Üíallspice (+4%) (cultural: 48%‚Üí66%, global: 93.4%)"], "menus_details": [{"starter": {"name": "Greek Salad", "ingredients": ["olive oil", "red wine vinegar", "dijon mustard", "dried oregano", "salt", "green bell pepper", "red onion", "tomatoes", "feta cheese"], "price": 14.0, "calories": 1088}, "main_course": {"name": "Bacon Mac and Cheese for Crockpot", "ingredients": ["cheese", "cheddar cheese", "garlic powder", "onion", "black pepper", "butter", "bacon", "milk"], "price": 14.0, "calories": 5550}, "dessert": {"name": "Blackberry Oatmeal Breakfast Cookies", "ingredients": ["coconut oil", "agave", "eggs", "vanilla extract", "whole wheat flour", "baking powder", "lemon zest", "ground cinnamon", "salt", "oats"], "price": 14.0, "calories": 1912}, "beverage": {"name": "Ginger Lemon Blend", "price": 3.0, "alcoholic": false}, "total_price": 45.0, "total_calories": 8550, "similarity_score": 0.9285431850866417, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (8550 kcal) para spring\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad low podr√≠a no ser ideal para wedding\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}, {"starter": {"name": "Apple and Brussels Sprout Salad", "ingredients": ["white vinegar", "olive oil", "honey", "dijon mustard", "salt", "black pepper", "lemon juice", "red onion", "dates", "pistachios"], "price": 10.5, "calories": 1883}, "main_course": {"name": "Pineapple Sweet and Sour Chicken (Easy and Delicious!)", "ingredients": ["all-purpose flour", "ketchup", "pineapple juice", "sugar", "white vinegar", "salt"], "price": 14.0, "calories": 2719}, "dessert": {"name": "Accidentally Vegan Banana-Nut Muffins", "ingredients": ["bananas", "eggs", "sugar", "butter", "all-purpose flour", "baking powder", "walnuts", "bananas", "vegetable oil", "whole wheat flour"], "price": 14.0, "calories": 4478}, "beverage": {"name": "Fanta Orange", "price": 2.0, "alcoholic": false}, "total_price": 40.5, "total_calories": 9080, "similarity_score": 0.7368598767200167, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (9080 kcal) para spring\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad low podr√≠a no ser ideal para wedding\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}], "llm_evaluation": "Evaluaci√≥n del men√∫ propuesto:\n\nEl men√∫ no parece estar bien adaptado a la tradici√≥n libanesa, ya que none de los platos ofrecidos son t√≠picos de la cocina libanesa. El \"Greek Salad\" es un plato griego, el \"Bacon Mac and Cheese\" es un plato estadounidense y los \"Blackberry Oatmeal Breakfast Cookies\" no parecen ser un postre tradicional liban√©s. \n\nEn cuanto al precio, el men√∫ total de 45.0‚Ç¨ est√° dentro del presupuesto de 27-55‚Ç¨ para 4 invitados, lo que es razonable para un evento de boda.\n\nLa combinaci√≥n de sabores y platos no parece ser muy coherente, ya que los platos son de diferentes tradiciones culinarias y no parecen complementarse bien entre s√≠.\n\nEn cuanto a las dietas, no hay restricciones diet√©ticas espec√≠ficas mencionadas en la solicitud.\n\nPRECIO: 4.5\nCULTURA: 1.5\nSABOR: 2.5\nGENERAL: 2.8", "llm_score": 2.8, "feedback_breakdown": {"overall_satisfaction": 2.8, "price_satisfaction": 4.5, "cultural_satisfaction": 1.5, "dietary_satisfaction": 2.0, "flavor_satisfaction": 2.5}, "timestamp": "2026-01-09T20:14:01.588825"}, {"request_num": 4, "generated_request": {"event_type": "CONGRESS", "num_guests": 28, "season": "SUMMER", "price_min": 20, "price_max": 50, "wants_wine": true, "required_diets": [], "restricted_ingredients": ["eggs"], "preferred_style": null, "cultural_preference": null}, "proposed_dishes": ["Sesame Chicken Salad with Honey Sesame Dressing", "Bacon Mac and Cheese for Crockpot", "Strawberry Pomegranete Sorbet", "Horiatiki Salata (Greek Salad)", "Grilled Polenta with Spicy Steak", "DEEP DISH CARAMEL APPLE PIE", "Russian Tomato and Cucumber Salad", "Crockpot Honey Sesame Chicken", "PinÃÉa Colada Bars"], "adaptations_made": ["Sustituido Southern Baked Parmesan Chicken, Courgette, Tomato and Bulgur Wheat Summer Salad Bowl por Horiatiki Salata (Greek Salad) (m√°s apropiado para summer)", "Sustituido Leftover Turkey Corn Chowder por Low Carb Mushroom Soup (ahorro: 3.50‚Ç¨)", "Sustituido Low Carb Mushroom Soup por Russian Tomato and Cucumber Salad (m√°s apropiado para summer)"], "menus_details": [{"starter": {"name": "Sesame Chicken Salad with Honey Sesame Dressing", "ingredients": ["chicken breasts", "romaine lettuce", "carrots", "noodles", "honey", "rice wine vinegar", "mayonnaise", "sesame oil", "salt", "dijon mustard"], "price": 7.0, "calories": 2618}, "main_course": {"name": "Bacon Mac and Cheese for Crockpot", "ingredients": ["cheese", "cheddar cheese", "garlic powder", "onion", "black pepper", "butter", "bacon", "milk"], "price": 14.0, "calories": 5550}, "dessert": {"name": "Strawberry Pomegranete Sorbet", "ingredients": ["sugar", "lemon juice", "cornstarch", "strawberries"], "price": 10.5, "calories": 1072}, "beverage": {"name": "Josh Cellars Cabernet Sauvignon", "price": 4.0, "alcoholic": true}, "total_price": 35.5, "total_calories": 9240, "similarity_score": 0.7961224035942174, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (9240 kcal) para summer\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad low podr√≠a no ser ideal para congress\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}, {"starter": {"name": "Horiatiki Salata (Greek Salad)", "ingredients": ["tomatoes", "red onion", "feta cheese", "olive oil", "red wine vinegar", "oregano", "salt", "black pepper"], "price": 14.0, "calories": 172}, "main_course": {"name": "Grilled Polenta with Spicy Steak", "ingredients": ["vegetable oil", "salt", "cumin", "chili powder", "black pepper", "avocado", "cilantro", "salsa", "lime"], "price": 14.0, "calories": 3337}, "dessert": {"name": "DEEP DISH CARAMEL APPLE PIE", "ingredients": ["walnuts", "oats", "dates", "coconut oil", "salt", "dates", "salt", "vanilla extract", "ground cinnamon", "water"], "price": 14.0, "calories": 5679}, "beverage": {"name": "Caymus Cabernet Sauvignon", "price": 8.0, "alcoholic": true}, "total_price": 50.0, "total_calories": 9188, "similarity_score": 0.7678110950328528, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'warning\', category=\'flavors\', message=\'Los sabores del entrante y principal podr√≠an no armonizar bien\', suggestion=\'Buscar platos con sabores m√°s complementarios\')", "ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (9188 kcal) para summer\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad high podr√≠a no ser ideal para congress\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}, {"starter": {"name": "Russian Tomato and Cucumber Salad", "ingredients": ["tomatoes", "onion", "mayonnaise", "black pepper", "salt"], "price": 10.5, "calories": 526}, "main_course": {"name": "Crockpot Honey Sesame Chicken", "ingredients": ["chicken thighs", "salt", "black pepper", "honey", "soy sauce", "ketchup", "vegetable oil", "garlic", "onion", "red pepper flakes"], "price": 14.0, "calories": 2094}, "dessert": {"name": "PinÃÉa Colada Bars", "ingredients": ["butter", "cream cheese", "pineapple"], "price": 14.0, "calories": 5240}, "beverage": {"name": "Stag\'s Leap Cabernet", "price": 9.0, "alcoholic": true}, "total_price": 47.5, "total_calories": 7860, "similarity_score": 0.7402669143963563, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (7860 kcal) para summer\', suggestion=\'Considerar opciones m√°s ligeras\')", "ValidationIssue(severity=\'warning\', category=\'complexity\', message=\'Complejidad low podr√≠a no ser ideal para congress\', suggestion=\'Ajustar complejidad seg√∫n tipo de evento\')"], "warnings": []}}], "llm_evaluation": "La evaluaci√≥n del men√∫ se basa en las dimensiones de precio, cultura, sabor y cumplimiento de dietas. \n\nEl men√∫ propuesto, considerando el presupuesto establecido de 20-50‚Ç¨, se encuentra dentro del rango permitido, con un costo total de 35.5‚Ç¨, lo que sugiere que es adecuado para el evento. \n\nEn cuanto a la cultura, dado que no se especifican preferencias culturales, la evaluaci√≥n se centra en la coherencia y variedad de los platos ofrecidos. El men√∫ ofrece una mezcla de sabores y platos que podr√≠an ser atractivos para una audiencia diversa.\n\nLos sabores y combinaciones de ingredientes parecen coherentes, con una variedad de texturas y gustos que podr√≠an complementarse bien. El entrante de ensalada de pollo con aderezo de miel y s√©samo, el plato principal de macarrones con queso y tocino, y el postre de sorbete de fresa y granada ofrecen una buena secuencia de sabores.\n\nEn cuanto a las dietas, no se indican restricciones espec√≠ficas, por lo que se asume que el men√∫ es adecuado en este aspecto.\n\nPRECIO: 4.5\nCULTURA: 3.5\nSABOR: 4.2\nGENERAL: 4.0", "llm_score": 4.0, "feedback_breakdown": {"overall_satisfaction": 4.0, "price_satisfaction": 4.5, "cultural_satisfaction": 3.5, "dietary_satisfaction": 5.0, "flavor_satisfaction": 4.2}, "timestamp": "2026-01-09T20:14:03.413115"}, {"request_num": 5, "generated_request": {"event_type": "COMMUNION", "num_guests": 14, "season": "SPRING", "price_min": 26, "price_max": 43, "wants_wine": false, "required_diets": ["vegan"], "restricted_ingredients": ["dairy", "eggs"], "preferred_style": "SIBARITA", "cultural_preference": null}, "proposed_dishes": ["Cannellini Bean & Roasted Red Pepper Sandwich", "Salsa Spaghetti Squash 3", "Strawberry Pomegranete Sorbet", "5-Minute Raspberry Summer Salad", "Bali in a Bowl", "Avocado coconut ice cream", "Weight Watchers Potato & Parsnip Soup", "Bolognese Sauce with Nuts", "Apple Pie Granola"], "adaptations_made": ["Plato cambiado: Spinach and Artichoke Chicken Skillet ‚Üí Miso-Orange Glazed Grilled Sweet Potatoes (cumple vegan)", "Plato cambiado: PAPER BAG APPLE PIE ‚Üí Meyer Lemon and Cantaloupe Ice (cumple vegan)", "Sustituido Miso-Orange Glazed Grilled Sweet Potatoes por Salsa Spaghetti Squash 3 (ahorro: 3.50‚Ç¨)", "Sustituido Meyer Lemon and Cantaloupe Ice por Strawberry Pomegranete Sorbet (ahorro: 3.50‚Ç¨)", "Sustituido Roasted bell pepper soup recipe| soup recipes| por Cannellini Bean & Roasted Red Pepper Sandwich (ahorro: 3.50‚Ç¨)", "‚ö†Ô∏è No se pudo reducir completamente el precio (faltan 15.50‚Ç¨)", "Cambiado Opus One por Anise Chamomile (sin alcohol)", "BROCCOLI LASAGNA BIANCA: milk‚Üíalmond milk (Dietary: violates vegan, same group (milk_group))", "Plato cambiado: Crop Pot Apple Crisp ‚Üí DEEP DISH CARAMEL APPLE PIE (cumple vegan)", "Sustituido BROCCOLI LASAGNA BIANCA por Bali in a Bowl (ahorro: 7.00‚Ç¨)", "Sustituido Carrot Rainbow salad with Mung por 5-Minute Raspberry Summer Salad (ahorro: 7.00‚Ç¨)", "Sustituido DEEP DISH CARAMEL APPLE PIE por Avocado coconut ice cream (ahorro: 3.50‚Ç¨)", "‚ö†Ô∏è No se pudo reducir completamente el precio (faltan 5.00‚Ç¨)", "Plato cambiado: Grilled Corn Salad with Marinated Shrimp ‚Üí Skinny Tangy Triple Bean Salad (cumple vegan)", "Plato cambiado: Meaty, Cheesy Stuffed Bell Peppers ‚Üí Bolognese Sauce with Nuts (cumple vegan)", "Plato cambiado: Pineapple Upside Down Biscuits ‚Üí Apple Pie Granola (cumple vegan)", "Sustituido Skinny Tangy Triple Bean Salad por Weight Watchers Potato & Parsnip Soup (ahorro: 28.00‚Ç¨)", "Cambiado Stag\'s Leap Cabernet por Ginger Lemon Blend (sin alcohol)", "‚öôÔ∏è Precios ajustados preventivamente (-2.00‚Ç¨ para cumplir presupuesto)"], "menus_details": [{"starter": {"name": "Cannellini Bean & Roasted Red Pepper Sandwich", "ingredients": ["cannellini beans", "garlic", "yellow onions", "olive oil", "rosemary", "thyme", "lemon juice", "salt", "black pepper", "parsley"], "price": 7.0, "calories": 1555}, "main_course": {"name": "Salsa Spaghetti Squash 3", "ingredients": ["onion", "salsa", "black beans", "cilantro", "avocado"], "price": 13.681818181818182, "calories": 1016}, "dessert": {"name": "Strawberry Pomegranete Sorbet", "ingredients": ["sugar", "lemon juice", "cornstarch", "strawberries"], "price": 10.5, "calories": 1072}, "beverage": {"name": "Anise Chamomile", "price": 2.6, "alcoholic": false}, "total_price": 34.1, "total_calories": 3643, "similarity_score": 0.5988454012247688, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (3643 kcal) para spring\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}, {"starter": {"name": "5-Minute Raspberry Summer Salad", "ingredients": ["lettuce", "raspberries", "avocado", "olive oil", "lemon", "salt", "black pepper"], "price": 7.0, "calories": 457}, "main_course": {"name": "Bali in a Bowl", "ingredients": ["vegetable oil", "carrots", "celery", "onion", "ginger", "vegetable broth", "russet potatoes", "brown sugar", "coconut milk", "lime"], "price": 21.0, "calories": 1083}, "dessert": {"name": "Avocado coconut ice cream", "ingredients": ["avocado", "coconut milk", "sugar", "lime juice", "rum", "salt"], "price": 10.5, "calories": 1931}, "beverage": {"name": "Fennel Digestive", "price": 2.5, "alcoholic": false}, "total_price": 41.0, "total_calories": 3471, "similarity_score": 0.5800526295875816, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (3471 kcal) para spring\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}, {"starter": {"name": "Weight Watchers Potato & Parsnip Soup", "ingredients": ["onion", "garlic", "potatoes", "herbs", "broth", "salt", "black pepper"], "price": 13.377777777777778, "calories": 740}, "main_course": {"name": "Bolognese Sauce with Nuts", "ingredients": ["nuts", "onion", "garlic", "olive oil", "tomatoes", "tomato paste", "oregano", "salt", "cayenne pepper", "basil"], "price": 13.377777777777778, "calories": 1281}, "dessert": {"name": "Apple Pie Granola", "ingredients": ["oats", "almonds", "shredded coconut", "pumpkin pie spice", "coconut oil", "brown sugar", "brown sugar", "maple syrup", "maple syrup", "salt"], "price": 10.657060518731988, "calories": 3063}, "beverage": {"name": "Ginger Lemon Blend", "price": 2.8666666666666667, "alcoholic": false}, "total_price": 43.0, "total_calories": 5084, "similarity_score": 0.5701213945249773, "validation": {"passed": true, "issues": ["ValidationIssue(severity=\'info\', category=\'calories\', message=\'Men√∫ contundente (5084 kcal) para spring\', suggestion=\'Considerar opciones m√°s ligeras\')"], "warnings": []}}], "llm_evaluation": "La evaluaci√≥n del men√∫ propuesto para el evento de comuni√≥n muestra algunos puntos fuertes y d√©biles. El men√∫ es vegano, cumple con la restricci√≥n diet√©tica solicitada. Los platos como el \"Cannellini Bean & Roasted Red Pepper Sandwich\" y el \"Strawberry Pomegranete Sorbet\" ofrecen combinaciones de sabores interesantes. Sin embargo, la ausencia de una preferencia cultural espec√≠fica y el enfoque en un estilo sibarita pueden influir en la percepci√≥n del men√∫.\n\nEn cuanto al precio, el men√∫ total de 34.1‚Ç¨ se encuentra dentro del presupuesto establecido de 26-43‚Ç¨, lo que es apropiado para el evento. La cultura no es un factor relevante en este caso debido a la falta de especificaciones, pero el esfuerzo por adaptar ingredientes a una opci√≥n vegana es notable. Los sabores y combinaciones de ingredientes parecen coherentes, con una variedad de texturas y sabores que podr√≠an complacer a los invitados.\n\nPRECIO: 4.5\nCULTURA: 3.0\nSABOR: 4.2\nGENERAL: 4.0", "llm_score": 4.0, "feedback_breakdown": {"overall_satisfaction": 4.0, "price_satisfaction": 4.5, "cultural_satisfaction": 3.0, "dietary_satisfaction": 5.0, "flavor_satisfaction": 4.2}, "timestamp": "2026-01-09T20:14:05.064805"}], "start_time": "2026-01-09T20:13:57.301133", "end_time": "2026-01-09T20:14:05.565585", "duration_seconds": 8.264452, "total_requests": 5, "successful_proposals": 5, "llm_evaluation": "RESUMEN DE EVALUACIONES INDIVIDUALES:\n==================================================\n\nSolicitud #1:\n  Evento: CORPORATE\n  Puntuaci√≥n: 4.0/5.0\n  Comentario: La evaluaci√≥n del men√∫ propuesto se basa en las dimensiones de precio, cultura, sabor y dieta....\n\nSolicitud #2:\n  Evento: CORPORATE\n  Puntuaci√≥n: 4.0/5.0\n  Comentario: La evaluaci√≥n del men√∫ propuesto se centra en varias dimensiones clave. En cuanto al precio, el men√∫...\n\nSolicitud #3:\n  Evento: WEDDING\n  Puntuaci√≥n: 2.8/5.0\n  Comentario: Evaluaci√≥n del men√∫ propuesto:...\n\nSolicitud #4:\n  Evento: CONGRESS\n  Puntuaci√≥n: 4.0/5.0\n  Comentario: La evaluaci√≥n del men√∫ se basa en las dimensiones de precio, cultura, sabor y cumplimiento de dietas...\n\nSolicitud #5:\n  Evento: COMMUNION\n  Puntuaci√≥n: 4.0/5.0\n  Comentario: La evaluaci√≥n del men√∫ propuesto para el evento de comuni√≥n muestra algunos puntos fuertes y d√©biles...\n\n==================================================\nPUNTUACI√ìN PROMEDIO: 3.76/5.00", "llm_score": 3.7600000000000002, "summary": {"avg_dishes_per_request": 8.4, "avg_adaptations_per_request": 7.8, "success_rate": 100.0}};
        
        // Renderizar inmediatamente
        renderStats(embeddedData);
        renderInteractions(embeddedData);

        function renderStats(data) {
            const statsContainer = document.getElementById('stats');
            
            const stats = [
                { label: 'Interacciones', value: data.config.num_interactions },
                { label: 'Tasa de √âxito', value: `${data.summary.success_rate.toFixed(1)}%` },
                { label: 'Puntuaci√≥n Media', value: `${data.llm_score.toFixed(2)}/5.00` },
                { label: 'Duraci√≥n', value: `${data.duration_seconds.toFixed(2)}s` }
            ];

            stats.forEach(stat => {
                const card = document.createElement('div');
                card.className = 'stat-card';
                card.innerHTML = `
                    <div class="stat-value">${stat.value}</div>
                    <div class="stat-label">${stat.label}</div>
                `;
                statsContainer.appendChild(card);
            });

            document.getElementById('timestamp').textContent = new Date(data.end_time).toLocaleString('es-ES');
        }

        function renderInteractions(data) {
            const container = document.getElementById('interactions');
            
            data.interactions.forEach((interaction, index) => {
                const card = document.createElement('div');
                card.className = 'interaction-card';
                card.id = `interaction-${index}`;
                
                const request = interaction.generated_request;
                const menus = interaction.menus_details || [];
                const bestMenu = menus.length > 0 ? menus.reduce((best, menu) => 
                    menu.similarity_score > (best.similarity_score || 0) ? menu : best
                ) : null;

                card.innerHTML = `
                    <div class="interaction-header" onclick="toggleCollapse(${index})">
                        <h3>
                            Solicitud #${interaction.request_num} - ${request.event_type}
                        </h3>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <span class="score-badge">‚≠ê ${interaction.llm_score.toFixed(1)}/5.0</span>
                            <button class="collapse-btn" id="btn-${index}">‚ñº</button>
                        </div>
                    </div>
                    
                    <div class="interaction-content" id="content-${index}">
                        ${renderRequestDetails(request)}
                        ${renderFeedbackBreakdown(interaction.feedback_breakdown)}
                        ${renderProposedDishes(interaction.proposed_dishes)}
                        ${renderAdaptations(interaction.adaptations_made)}
                        ${menus.length > 0 ? renderMenus(menus, bestMenu) : ''}
                        ${renderLLMEvaluation(interaction.llm_evaluation)}
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function renderRequestDetails(request) {
            const diets = request.required_diets || [];
            const ingredients = request.restricted_ingredients || [];
            
            return `
                <div class="section">
                    <div class="section-title">üìã Detalles de la Solicitud</div>
                    <div class="request-details">
                        <div class="request-item">
                            <span class="request-label">Evento:</span>
                            <span class="badge badge-event">${request.event_type}</span>
                        </div>
                        <div class="request-item">
                            <span class="request-label">Comensales:</span>
                            <span class="request-value">${request.num_guests}</span>
                        </div>
                        <div class="request-item">
                            <span class="request-label">Temporada:</span>
                            <span class="request-value">${request.season}</span>
                        </div>
                        <div class="request-item">
                            <span class="request-label">Presupuesto:</span>
                            <span class="request-value">$${request.price_min} - $${request.price_max}</span>
                        </div>
                        <div class="request-item">
                            <span class="request-label">Vino:</span>
                            <span class="request-value">${request.wants_wine ? 'üç∑ S√≠' : 'üö´ No'}</span>
                        </div>
                        ${request.preferred_style ? `
                        <div class="request-item">
                            <span class="request-label">Estilo:</span>
                            <span class="request-value">${request.preferred_style}</span>
                        </div>` : ''}
                        ${request.cultural_preference ? `
                        <div class="request-item">
                            <span class="request-label">Cultura:</span>
                            <span class="request-value">${request.cultural_preference}</span>
                        </div>` : ''}
                    </div>
                    ${diets.length > 0 ? `
                    <div style="margin-top: 15px;">
                        <strong>Dietas Requeridas:</strong><br>
                        ${diets.map(d => `<span class="badge badge-diet">${d}</span>`).join('')}
                    </div>` : ''}
                    ${ingredients.length > 0 ? `
                    <div style="margin-top: 10px;">
                        <strong>Ingredientes Restringidos:</strong><br>
                        ${ingredients.map(i => `<span class="badge badge-ingredient">${i}</span>`).join('')}
                    </div>` : ''}
                </div>
            `;
        }

        function renderFeedbackBreakdown(breakdown) {
            if (!breakdown) return '';
            
            const dimensions = [
                { key: 'price_satisfaction', label: 'üí∞ Precio', class: 'price' },
                { key: 'cultural_satisfaction', label: 'üåç Cultura', class: 'culture' },
                { key: 'flavor_satisfaction', label: 'üòã Sabor', class: 'flavor' },
                { key: 'dietary_satisfaction', label: 'ü•ó Dietas', class: 'dietary' },
                { key: 'overall_satisfaction', label: '‚≠ê General', class: 'overall' }
            ];

            return `
                <div class="section">
                    <div class="section-title">üìä Desglose del Feedback</div>
                    <div class="feedback-breakdown">
                        ${dimensions.map(dim => {
                            const value = breakdown[dim.key] || 0;
                            const percentage = (value / 5) * 100;
                            return `
                                <div class="feedback-item">
                                    <div class="feedback-label">${dim.label}</div>
                                    <div class="feedback-bar-container">
                                        <div class="feedback-bar ${dim.class}" style="width: ${percentage}%"></div>
                                    </div>
                                    <div class="feedback-value">${value.toFixed(1)}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function renderProposedDishes(dishes) {
            if (!dishes || dishes.length === 0) return '';
            
            return `
                <div class="section">
                    <div class="section-title">üçΩÔ∏è Platos Propuestos (${dishes.length})</div>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                        ${dishes.map(dish => `
                            <span class="badge" style="background: #e9ecef; color: #495057; padding: 8px 12px;">
                                ${dish}
                            </span>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderAdaptations(adaptations) {
            if (!adaptations || adaptations.length === 0) return '';
            
            return `
                <div class="section">
                    <div class="section-title">‚öôÔ∏è Adaptaciones Realizadas (${adaptations.length})</div>
                    <div class="adaptations-list">
                        ${adaptations.map(adapt => `
                            <div class="adaptation-item">
                                ${adapt.includes('ERROR') || adapt.includes('‚ö†Ô∏è') ? '‚ö†Ô∏è' : '‚úÖ'} ${adapt}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderMenus(menus, bestMenu) {
            return `
                <div class="section">
                    <div class="section-title">üçΩÔ∏è Men√∫s Generados (${menus.length})</div>
                    <div class="menus-grid">
                        ${menus.map((menu, idx) => {
                            const isBest = menu === bestMenu;
                            return `
                                <div class="menu-card ${isBest ? 'best' : ''}">
                                    <div class="menu-header">
                                        <span class="menu-title">
                                            ${isBest ? 'üèÜ ' : ''}Men√∫ ${idx + 1}
                                        </span>
                                        <span class="menu-price">$${menu.total_price.toFixed(2)}</span>
                                    </div>
                                    
                                    <div class="dish-item">
                                        <div class="dish-name">ü•ó Entrante: ${menu.starter.name}</div>
                                        <div class="dish-details">
                                            ${menu.starter.calories} kcal | $${menu.starter.price.toFixed(2)}
                                        </div>
                                    </div>
                                    
                                    <div class="dish-item">
                                        <div class="dish-name">üçñ Principal: ${menu.main_course.name}</div>
                                        <div class="dish-details">
                                            ${menu.main_course.calories} kcal | $${menu.main_course.price.toFixed(2)}
                                        </div>
                                    </div>
                                    
                                    <div class="dish-item">
                                        <div class="dish-name">üç∞ Postre: ${menu.dessert.name}</div>
                                        <div class="dish-details">
                                            ${menu.dessert.calories} kcal | $${menu.dessert.price.toFixed(2)}
                                        </div>
                                    </div>
                                    
                                    <div class="dish-item">
                                        <div class="dish-name">ü•§ Bebida: ${menu.beverage.name}</div>
                                        <div class="dish-details">
                                            ${menu.beverage.alcoholic ? 'üç∑ Con alcohol' : 'üö´ Sin alcohol'} | $${menu.beverage.price.toFixed(2)}
                                        </div>
                                    </div>
                                    
                                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                            <span>Total calor√≠as:</span>
                                            <strong>${menu.total_calories} kcal</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between;">
                                            <span>Similitud:</span>
                                            <strong>${(menu.similarity_score * 100).toFixed(1)}%</strong>
                                        </div>
                                    </div>
                                    
                                    ${menu.validation && menu.validation.issues && menu.validation.issues.length > 0 ? `
                                    <div style="margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 5px; font-size: 0.85rem;">
                                        <strong>‚ö†Ô∏è Observaciones:</strong><br>
                                        ${menu.validation.issues.slice(0, 2).map(issue => 
                                            issue.replace('ValidationIssue(', '').replace(/severity='(\w+)'/, '$1:').replace(/category='(\w+)'/, '').replace(/message='([^']+)'/, '$1').replace(/suggestion='[^']*'/, '').replace(/\)/g, '')
                                        ).join('<br>')}
                                    </div>` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function renderLLMEvaluation(evaluation) {
            if (!evaluation) return '';
            
            return `
                <div class="section">
                    <div class="section-title">ü§ñ Evaluaci√≥n del LLM</div>
                    <div class="llm-evaluation">
                        <div class="llm-evaluation-text">${evaluation}</div>
                    </div>
                </div>
            `;
        }

        function toggleCollapse(index) {
            const content = document.getElementById(`content-${index}`);
            const btn = document.getElementById(`btn-${index}`);
            
            if (content.classList.contains('content-collapsed')) {
                content.classList.remove('content-collapsed');
                btn.classList.remove('collapsed');
            } else {
                content.classList.add('content-collapsed');
                btn.classList.add('collapsed');
            }
        }
    </script>
</body>
</html>
